<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Quiz Interativo - HTML, CSS e JavaScript</title>
    <meta
      name="description"
      content="Escolha um tema, responda as questões e mostre que você é fera no assunto!"
    />
    <meta
      property="og:title"
      content="Quiz Interativo - HTML, CSS e JavaScript"
    />
    <meta property="og:image" content="./icons/icon.png" />
    <meta property="og:image:width" content="1200" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"
    />
    <link rel="icon" type="image/png" href="favicon.png" />
    <link rel="stylesheet" href="style/styles.css" />
    <link rel="stylesheet" href="./style/dark-theme.css" />
  </head>
  <body>
    <main class="main">
      <header class="header">
        <a href="#" class="logo">Quiz.</a>
      </header>

      <div class="container">
        <section class="quiz-section">
          <div class="cronometro-container">
            <div id="cronometro" class="cronometro">00:00:00</div>
          </div>
          <div class="quiz-box">
            <h1 class="quiz-title">Quiz Interativo</h1>
            <div class="quiz-header">
              <span>Quiz Squad6</span>
              <span class="header-score">Pontuação: 0 / 10</span>
            </div>
            <h2 class="question-text"></h2>
            <div class="option-list">
              <div class="option">
                <span></span>
              </div>
            </div>

            <div class="quiz-footer">
              <span class="question-total">1 de 10 Questões</span>
              <button class="goHome-btn">Home</button>
              <button class="next-btn">Próxima</button>
            </div>
          </div>

          <div class="result-box-container">
            <div class="result-container">
              <div class="result-box">
                <h2>Resultado</h2>
                <div class="percentage-container">
                  <div class="circular-progress">
                    <span class="progress-value"> 0% </span>
                  </div>
                  <span class="score-text">Sua pontuação 0 de 10</span>
                </div>
                <div class="buttons">
                  <button class="tryAgain-btn">Refazer</button>
                  <button class="goHome-btn">Home</button>
                </div>
              </div>

              <div class="insights-container">
                <div class="insight">
                  <h3>HTML</h3>
                  <p>Média de acertos: <span id="html-average">0</span></p>
                  <p>Média de erros: <span id="html-errors">0</span></p>
                  <p>Pontuação média: <span id="html-average-score">0</span></p>
                  <p>Ranking: <span id="html-ranking-score"></span></p>
                </div>
                <div class="insight">
                  <h3>CSS</h3>
                  <p>Média de acertos: <span id="css-average">0</span></p>
                  <p>Média de erros: <span id="css-errors">0</span></p>
                  <p>Pontuação média: <span id="css-average-score">0</span></p>
                  <p>Ranking: <span id="css-ranking-score"></span></p>
                </div>
                <div class="insight">
                  <h3>JavaScript</h3>
                  <p>
                    Média de acertos: <span id="javascript-average">0</span>
                  </p>
                  <p>Média de erros: <span id="javascript-errors">0</span></p>
                  <p>
                    Pontuação média:
                    <span id="javascript-average-score">0</span>
                  </p>
                  <p>Ranking: <span id="javascript-ranking-score"></span></p>
                </div>
              </div>
            </div>

            <div class="ranking-box">
              <div class="ranking-container">
                <h2>Ranking</h2>
                <table>
                  <thead>
                    <tr>
                      <th>Nome do Participante</th>
                      <th>Pontuação HTML</th>
                      <th>Pontuação CSS</th>
                      <th>Pontuação JavaScript</th>
                      <th>Tempo de Resposta</th>
                      <th>Data do Quiz</th>
                    </tr>
                  </thead>
                  <tbody></tbody>
                </table>
              </div>
            </div>
          </div>
        </section>

        <section class="home">
          <div class="home_content">
            <h1>Quiz Interativo</h1>

            <p>Insira seu nome e escolha um tema:</p>
            <div class="participant-input">
              <label for="participantName">Seu nome:*</label>
              <input
                type="text"
                id="participantName"
                placeholder="Nome é obrigatório!"
              />
            </div>
            <div class="theme-buttons">
              <button class="html-theme">HTML</button>
              <button class="css-theme">CSS</button>
              <button class="js-theme">JavaScript</button>
            </div>
            <button class="start-btn">Iniciar</button>
          </div>
        </section>
      </div>
    </main>

    <div class="popup-info">
      <h2>Vamos testar seus conhecimentos?</h2>
      <span class="info"
        >1. Somente uma das opções é a resposta correta para cada
        pergunta.</span
      >
      <span class="info">2.Analise bem as opções antes de escolher uma.</span>
      <span class="info"
        >3. Ao finalizar o quiz, verifique suas respostas, quantas questões
        acertou e errou, e o tempo decorrido.</span
      >
      <span class="info"
        >4.Além disso, ofereceremos alguns insights interessantes, como a média
        de acertos por tema e o ranking de pontuação por tema</span
      >
      <span class="info"
        >5. Se desejar, reinicie o quiz e escolha outro tema para desafiar seus
        conhecimentos novamente.</span
      >
      <span class="info"
        >Aproveite o Quiz Interativo e divirta-se testando seus conhecimentos em
        HTML, CSS e JavaScript! Boa sorte e bons estudos!</span
      >

      <div class="btn-group">
        <button class="info-btn exit-btn">Sair do Quiz</button>
        <a href="#" class="info-btn continue-btn">Continue</a>
      </div>
    </div>
    <audio controls id="audioPlayer">
      <source src="#" type="audio/mpeg" />
      Seu navegador não suporta o elemento de áudio.
    </audio>

    <button class="theme-toggle" onclick="toggleTheme()">
      <span id="iconToggle"><i class="fa">&#xf185;</i></span>
    </button>

    <script>
      const startBtn = document.querySelector(".start-btn");
      const popupInfo = document.querySelector(".popup-info");
      const exitBtn = document.querySelector(".exit-btn");
      const main = document.querySelector(".main");
      const continueBtn = document.querySelector(".continue-btn");
      const quizSection = document.querySelector(".quiz-section");
      const quizBox = document.querySelector(".quiz-box");
      const resultBox = document.querySelector(".result-box");
      const nextBtn = document.querySelector(".next-btn");
      const tryAgainBtn = document.querySelector(".tryAgain-btn");
      const goHomeBtn = document.querySelector(".goHome-btn");
      const participantNameInput = document.getElementById("participantName");
      const themeSelect = document.getElementById("themeSelect");
      const showResultsBtn = document.querySelector(".show-results-btn");
      const rankingBox = document.querySelector(".ranking-box");
      const insightsContainer = document.querySelector(".insights-container");

      function updateStartBtnState() {
        const participantName = participantNameInput.value.trim();
        startBtn.disabled = participantName === "";
      }

      function showAlert(message) {
        alert(message);
      }

      updateStartBtnState();

      participantNameInput.addEventListener("input", () => {
        updateStartBtnState();
      });

      function startQuiz() {
        const participantName = participantNameInput.value.trim();
        if (participantName === "") {
          showAlert("É necessário inserir o nome antes de iniciar o quiz.");
        } else {
          popupInfo.classList.add("active");
          main.classList.add("active");
        }
      }

      startBtn.addEventListener("click", () => {
        startQuiz();
      });

      exitBtn.onclick = () => {
        popupInfo.classList.remove("active");
        main.classList.remove("active");
      };

      continueBtn.onclick = () => {
        quizSection.classList.add("active");
        popupInfo.classList.remove("active");
        main.classList.remove("active");
        quizBox.classList.add("active");

        showQuestions(0);
        questionCounter(1);
        headerScore();
      };

      let htmlQuestions = [];
      let cssQuestions = [];
      let jsQuestions = [];

      function selectTheme(theme) {
        switch (theme) {
          case "HTML":
            questions = htmlQuestions;
            break;
          case "CSS":
            questions = cssQuestions;
            break;
          case "JavaScript":
            questions = jsQuestions;
            break;
          default:
            questions = [];
        }
        questionCount = 0;
        questionNum = 1;
        userScore = 0;

        quizSection.classList.add("active");
        popupInfo.classList.remove("active");
        main.classList.remove("active");
        quizBox.classList.add("active");
        showQuestions(questionCount);
        questionCounter(questionNum);
        headerScore();
      }

      document
        .querySelector(".html-theme")
        .addEventListener("click", () => selectTheme("HTML"));
      document
        .querySelector(".css-theme")
        .addEventListener("click", () => selectTheme("CSS"));
      document
        .querySelector(".js-theme")
        .addEventListener("click", () => selectTheme("JavaScript"));

      let questionCount = 0;
      let questionNum = 1;
      let userScore = 0;

      nextBtn.onclick = () => {
        if (questionCount < questions.length - 1) {
          questionCount++;
          showQuestions(questionCount);

          questionNum++;
          questionCounter(questionNum);
          nextBtn.classList.remove("active");
        } else {
          showResultBox();
        }
      };

      function showQuestions(index) {
        const questionText = document.querySelector(".question-text");
        questionText.textContent = `${questions[index].num}. ${questions[index].question}`;

        const optionList = document.querySelector(".option-list");
        optionList.innerHTML = "";

        for (let i = 0; i < questions[index].options.length; i++) {
          const option = document.createElement("div");
          option.classList.add("option");

          const span = document.createElement("span");
          span.textContent = questions[index].options[i];

          option.appendChild(span);
          optionList.appendChild(option);
        }

        const options = document.querySelectorAll(".option");
        options.forEach((option) => {
          option.addEventListener("click", () => optionSelected(option));
        });
      }

      function optionSelected(answer) {
        if (quizBox.classList.contains("active")) {
          let userAnswer = answer.textContent.trim();
          let correctAnswer = questions[questionCount].answer.trim();
          let allOptions = document.querySelectorAll(".option");

          if (userAnswer === correctAnswer) {
            answer.classList.add("correct");
            userScore += 1;
            headerScore();
          } else {
            answer.classList.add("incorrect");

            for (let i = 0; i < allOptions.length; i++) {
              if (allOptions[i].textContent.trim() === correctAnswer) {
                allOptions[i].classList.add("correct");
              }
            }
          }

          for (let i = 0; i < allOptions.length; i++) {
            allOptions[i].classList.add("disabled");
          }
          nextBtn.classList.add("active");
        }
      }

      function questionCounter(index) {
        const questionTotal = document.querySelector(".question-total");
        questionTotal.textContent = `${index} of ${questions.length} Questions`;
      }

      function headerScore() {
        const headerScoreText = document.querySelector(".header-score");
        headerScoreText.textContent = `Score: ${userScore} / ${questions.length}`;
      }

      function animateCircularProgress() {
        const circularProgress = document.querySelector(
          ".percentage-container .circular-progress"
        );
        const progressValue = document.querySelector(
          ".percentage-container .progress-value"
        );
        let progressStartValue = 0;
        let progressEndValue = (userScore / questions.length) * 100;
        let speed = 20;

        let progress = setInterval(() => {
          progressStartValue++;

          progressValue.textContent = `${progressStartValue}%`;
          circularProgress.style.background = `conic-gradient(#ff0157 ${
            progressStartValue * 3.6
          }deg, rgba(255, 255, 255, 0.1) ${progressStartValue * 3.6}deg)`;

          if (progressStartValue == progressEndValue) {
            clearInterval(progress);
          }
        }, speed);
      }

      function showResultBox() {
        quizBox.classList.remove("active");
        resultBox.classList.add("active");

        const scoreText = document.querySelector(".score-text");
        scoreText.textContent = `Sua pontuação: ${userScore} de ${questions.length}`;

        animateCircularProgress();
        setTimeout(() => {
          rankingBox.classList.add("active");
          insightsContainer.classList.add("active");
          fillResultsTable();
        }, 800);
      }

      function fillResultsTable() {
        const resultTableBody = document.querySelector(
          ".ranking-container tbody"
        );

        resultTableBody.innerHTML = "";

        participantsData.forEach((participant) => {
          const row = document.createElement("tr");
          row.innerHTML = `
            <td>${participant.name}</td>
            <td>${participant.scores.HTML}</td>
            <td>${participant.scores.CSS}</td>
            <td>${participant.scores.JavaScript}</td>
            <td>${participant.timeTaken}</td>
            <td>${formatDate(participant.date)}</td>
          `;
          resultTableBody.appendChild(row);
        });

        updateInsights();
      }

      function formatDate(dateString) {
        const date = new Date(dateString);
        return date.toLocaleDateString("pt-BR");
      }

      function toggleTheme() {
        const body = document.body;
        const iconToggle = document.getElementById("iconToggle");

        if (body.classList.contains("dark-theme")) {
          body.classList.remove("dark-theme");
          body.classList.add("light-theme");
          iconToggle.innerHTML = '<i class="fa">&#xf186;</i>';
        } else {
          body.classList.remove("light-theme");
          body.classList.add("dark-theme");
          iconToggle.innerHTML = '<i class="fa">&#xf185;</i>';
        }
      }

      function togglePlayPause() {
        const audio = document.getElementById("audioPlayer");
        if (audio.paused) {
          audio.play();
        } else {
          audio.pause();
        }
      }

      function formatDate(dateString) {
        const date = new Date(dateString);
        return date.toLocaleDateString("pt-BR");
      }

      function showQuestions(index) {
        const questionText = document.querySelector(".question-text");
        questionText.textContent = `${questions[index].num}. ${questions[index].question}`;

        const optionList = document.querySelector(".option-list");
        optionList.innerHTML = "";

        for (let i = 0; i < questions[index].options.length; i++) {
          const option = document.createElement("div");
          option.classList.add("option");

          const span = document.createElement("span");
          span.textContent = questions[index].options[i];

          option.appendChild(span);
          optionList.appendChild(option);
        }

        const options = document.querySelectorAll(".option");
        options.forEach((option) => {
          option.addEventListener("click", () => optionSelected(option));
        });
      }

      function optionSelected(answer) {
        if (quizBox.classList.contains("active")) {
          let userAnswer = answer.textContent.trim();
          let correctAnswer = questions[questionCount].answer.trim();
          let allOptions = document.querySelectorAll(".option");

          if (userAnswer === correctAnswer) {
            answer.classList.add("correct");
            userScore += 1;
            headerScore();
          } else {
            answer.classList.add("incorrect");

            for (let i = 0; i < allOptions.length; i++) {
              if (allOptions[i].textContent.trim() === correctAnswer) {
                allOptions[i].classList.add("correct");
              }
            }
          }

          for (let i = 0; i < allOptions.length; i++) {
            allOptions[i].classList.add("disabled");
          }
          nextBtn.classList.add("active");
        }
      }

      function questionCounter(index) {
        const questionTotal = document.querySelector(".question-total");
        questionTotal.textContent = `${index} of ${questions.length} Questions`;
      }

      function headerScore() {
        const headerScoreText = document.querySelector(".header-score");
        headerScoreText.textContent = `Score: ${userScore} / ${questions.length}`;
      }

      function animateCircularProgress() {
        const circularProgress = document.querySelector(
          ".percentage-container .circular-progress"
        );
        const progressValue = document.querySelector(
          ".percentage-container .progress-value"
        );
        let progressStartValue = 0;
        let progressEndValue = (userScore / questions.length) * 100;
        let speed = 20;

        let progress = setInterval(() => {
          progressStartValue++;

          progressValue.textContent = `${progressStartValue}%`;
          circularProgress.style.background = `conic-gradient(#ff0157 ${
            progressStartValue * 3.6
          }deg, rgba(255, 255, 255, 0.1) ${progressStartValue * 3.6}deg)`;

          if (progressStartValue == progressEndValue) {
            clearInterval(progress);
          }
        }, speed);
      }

      function showResultBox() {
        quizBox.classList.remove("active");
        resultBox.classList.add("active");

        const scoreText = document.querySelector(".score-text");
        scoreText.textContent = `Sua pontuação: ${userScore} de ${questions.length}`;

        animateCircularProgress();
        setTimeout(() => {
          rankingBox.classList.add("active");
          insightsContainer.classList.add("active");
          fillResultsTable();
        }, 800);
      }

      const participantsData = [
        {
          name: "João",
          scores: {
            HTML: 8,
            CSS: 7,
            JavaScript: 9,
          },
          timeTaken: "10 minutos",
          date: "2023-08-01",
        },
        {
          name: "Maria",
          scores: {
            HTML: 7,
            CSS: 6,
            JavaScript: 8,
          },
          timeTaken: "12 minutos",
          date: "2023-08-02",
        },
      ];
    </script>
  </body>
</html>
